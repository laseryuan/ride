#!/bin/bash

if [[ "$1" == "mount" ]]; then
  mount_flag=mount
  shift
fi

first=$1
arrIN=(${first//@/ })
if [ -z "${arrIN[1]}"  ]; then
  USER=ride
  SSHME_SERVER=${arrIN[0]}
else
  USER=${arrIN[0]}
  SSHME_SERVER=${arrIN[1]}
fi

shift

if [[ "$mount_flag" == "mount" ]]; then
  sshstart $mount_flag

  SSH_FORWARD_PORT=12322
  ssh \
    -o StrictHostKeyChecking=no \
    -J sish.unsown.top:2222 \
    -R ${SSH_FORWARD_PORT}:localhost:22 \
    ${USER}@${SSHME_SERVER}
else
  ssh \
    -o StrictHostKeyChecking=no \
    -J sish.unsown.top:2222 \
    ${USER}@${SSHME_SERVER}
fi

